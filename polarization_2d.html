<!DOCTYPE html>
<html>
<meta  content="text/html; charset=UTF-8"  http-equiv="content-type">

<head>
    <title>Electric Field Reflection and Transmission</title>
    <link rel="stylesheet" href="static/main.css">
    <!-- <script src="static/math.min.js" type="text/javascript"></script> -->
    <script src="static/coordinate-system.js" type="text/javascript"></script>
    <script src="static/utility-functions.js" type="text/javascript"></script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        extensions: ["tex2jax.js"],
        jax: ["input/TeX","output/HTML-CSS"],
        tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]}
      });
    </script>
    <script type="text/javascript" async
      src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>

</head>

<body>
<div style="text-align:center" width:700px margin:auto>
    <h2>Plane Wave Polarization</h2>
    <canvas id="canvas" width="400" height="400"></canvas>
    <div style="text-align:center">
        <button id="idTogButton" onclick="toggleButton()">Start</button>
        <button id="idResetButton" onclick="resetButton()">Reset</button>
    </div>
    <p>TE: &nbsp;&nbsp; $r_s = \frac{n_1 - n_2}{n_1 + n_2}$,
           &nbsp;&nbsp; $t_s = \frac{2 n_1}{n_1 + n_2} = 1 + r_s$ </p>
    <p>TM: &nbsp;&nbsp; $r_p = \frac{n_2 - n_1}{n_2 + n_1}$,
           &nbsp;&nbsp; $t_p = \frac{2 n_1}{n_1 + n_2} = 1 - r_p$ </p>
    <br />

    <fieldset>
        <legend>Parameter controls</legend>
        <table cellspacing="0" cellpadding="0">
          <tr>
            <td align="right">
                <label for="idn1">
                    &Psi;&nbsp;</label>
            </td>
            <td>
                <input type="range" id="idpsi" min="0" max="90" value="45"
                       step="1" oninput="psiSliderUpdate(value)">
                <output for="idpsi" id="idpsiValue">45&deg;</output>
            </td>
          </tr>
          <tr>
            <td align="right">
                <label for="iddelta">
                    &delta;&nbsp;</label>
            </td>
            <td>
                <input type="range" id="iddelta" min="-179" max="180"
                    value="0" step="1" oninput="deltaSliderUpdate(value)">
                <output for="iddelta" id="iddeltaValue">0&deg;</output>
            </td>
          </tr>
        </table>
    </fieldset>
</div>

<p id="values" style="text-align:center"></p>

<button id="idPrintValues" onclick="print_values()">Print Values</button>


<script>

// console.log( range(-1,1,0.1) );
// console.log( range(-1,1,0.05) );
// console.log( range(-1,1,0.01) );

//------------------------------------------------------------------------------
// Main code
//------------------------------------------------------------------------------

timerRunning = false;

var deg_to_rad = Math.PI/180.;
var psi = Number(document.querySelector('#idpsi').value) * deg_to_rad;
var delta = Number(document.querySelector('#iddelta').value) * deg_to_rad;

console.log(document.querySelector('#idpsi').value);
console.log(document.querySelector('#iddelta').value);
console.log('deg_to_rad', deg_to_rad, psi, delta);

t_norm = range(-1, 1, 0.125);
x_coord = Array(t_norm.length);
y_coord = Array(t_norm.length);
calc_xy_coordinates();

print_values();

function calc_xy_coordinates() {
    var cos_psi = Math.cos(psi);
    var sin_psi = Math.sin(psi);
    for (var i=0; i<t_norm.length; i++) {
        x_coord[i] = cos_psi * Math.cos(2*Math.PI*t_norm[i]);
        y_coord[i] = sin_psi * Math.cos(2*Math.PI*t_norm[i] + delta);
    }
}

function print_values() {
    console.log('------------------------------');
    console.log('psi:', psi);
    console.log('cos:', Math.cos(psi));
    console.log('sin:', Math.sin(psi));
    console.log('delta:', delta)
    console.log(t_norm.length);
    for (var i=0; i<t_norm.length; i++) {
        console.log(i, t_norm[i], x_coord[i], y_coord[i]);
    }
}

function psiSliderUpdate(value) {
    document.querySelector('#idpsiValue').innerHTML = value.toString() + "&deg;" ;
    psi = Number(value) * deg_to_rad;
    if (!timerRunning) update();
}

function deltaSliderUpdate(value) {
    document.querySelector('#iddeltaValue').innerHTML = value.toString() + "&deg;";
    delta = Number(value) * deg_to_rad;
    if (!timerRunning) update();
}

function update() {
    calc_xy_coordinates();
}

</script>

</body>
</html>
